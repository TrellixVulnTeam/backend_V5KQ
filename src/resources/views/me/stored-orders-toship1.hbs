
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/manageProduct.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/main.css">
    {{!-- <link rel="stylesheet" href="../css/header.css"> --}}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
        integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w=="
        crossorigin="anonymous" />


    <title>Document</title>
</head>

<body>

    <form class="container-fluid app-content" name="container-form" method="POST" action="/me/stored/handle-form-actions">
        <div class="row app-content0">
            <div class="col-2 col1 d-flex">
                  <nav class="category1">
                    <div class="category__info">
                        <div class="info-image">
                            <img src={{seller.avatar}} alt="avatar">
                        </div>
                        
                        <div class="info-name">
                                {{seller.username}}
                        </div>
                           
                       
                    </div>
                    <h3 class="category__heading">
                        Tài khoản của tôi
                    </h3>
                    <ul class="category-list">
                        <li class="category-item">
                            <a href="/seller/info" class="category-item__link">Hồ sơ</a>
                        </li>
                    

                    </ul>
                    <h3 class="category__heading">
                        Quản lý sản phẩm
                    </h3>
                    <ul class="category-list">
                        <li class="category-item">
                            <a href="/me/stored/books" class="category-item__link">Tất cả sản phẩm</a>
                        </li>
                        <li class="category-item">
                            <a href="/books/create" class="category-item__link">Thêm sản phẩm</a>
                        </li>

                    </ul>
                    <h3 class="category__heading">
                        Quản lý đơn hàng
                    </h3>
                    <ul class="category-list">
                        <li class="category-item">
                            <a href="/me/stored/orders/all" class="category-item__link">Tất cả đơn hàng</a>
                        </li>
                        <li class="category-item">
                            <a href="/me/stored/orders/canceled" class="category-item__link">Đơn huỷ</a>
                        </li>
                        <li class="category-item">
                            <a href="/me/stored/orders/return" class="category-item__link">Trả hàng/Hoàn tiền</a>
                        </li>

                    </ul>

                     <h3 class="category__heading">
                        Thanh toán
                    </h3>
                    <ul class="category-list">
                        <li class="category-item">
                            <a href="/me/payment/unpaid" class="category-item__link">Sẽ thanh toán</a>
                        </li>
                        <li class="category-item">
                            <a href="/me/payment/paid" class="category-item__link">Đã thanh toán</a>
                        </li>
                        
                    </ul>
                </nav>

            </div>
            <div class="col">
                <div class="container-fluid">
                    <div class="app-content-2">
                        <div class="manage-product-tab">
                            <a class="btn1 btn-tab active" href="/me/stored/orders/all" >
                                Tất cả <span class="sr-only">(current)</span>
                            </a>
                            <a class="btn1 btn-tab" href="/me/stored/orders/notapproved">
                                Chờ xác nhận
                            </a>
                            <a class="btn1 btn-tab" href="/me/stored/orders/toship">
                                Chờ lấy hàng
                            </a>
                            <a class="btn1 btn-tab" href="/me/stored/orders/shipping">
                                Đang giao
                            </a>
                            <a class="btn1 btn-tab" href="/me/stored/orders/completed">
                                Đã giao
                            </a>
                            <a class="btn1 btn-tab" href="/me/stored/orders/canceled">
                                Đơn huỷ
                            </a>
                            <a class="btn1 btn-tab" href="/me/stored/orders/return">
                                Trả hàng/Hoàn tiền
                            </a>
                        </div>
                    </div>

                  

                    <div class="app-content-1">
                        
                        <div class="app-content-3">
                            <div class="d-flex align-items-center justify-content-lg-between">
                                <div class="p-2 flex-fill">
                                    <div class="manage-product-search__input" placeholder="Tìm đơn hàng" type="search">
                                        <div class="manage-product-search__input-1">
                                            <input class="form-control search-input" placeholder="Tìm sản phẩm"
                                                type="search">
                                        </div>
                                        <div class="manage-product-search__input-2">
                                            <i class="fas fa-search manage-product-search__icon"></i>
                                        </div>

                                    </div>  
                                </div>
                                <div class="p-2 flexx-fill d-flex align-items-center">
                                    <div class="manage-product-order  d-flex align-items-center ">

                                        <div class="p-2">
                                            <div class="manage-product-order__label">
                                                Ngày đặt hàng
                                            </div>
                                        </div>
                                        <div class="p-2">
                                            <div class="manage-product-order__input">
                                                <input class="form-control input-date">

                                            </div>
                                        </div>
                                        <div class="p-2">
                                            <button class="btn1 manage-product-order__btn">
                                                Xuất
                                            </button>
                                        </div>

                                    </div>
                                </div>


                            </div>
                            
                            <div class="app-content-4 d-flex align-items-center justify-content-between">
                                <div class="orders-label">
                                    Đơn hàng
                                </div>
                                <div class="orders-btn">
                                    <button class="btn1 btn--primary">
                                        Giao hàng loạt
                                    </button>
                                </div>
                            </div>

                          <div class="manage-order-action mt-4 d-flex align-items-center justify-content-between">
                              <div class="form-check d-flex align-item-center">
                              <input class="form-check-input check-input1" type="checkbox" value="" id="checkbox-all">
                              <label class="form-check-label" for="checkbox-all">
                                 Chọn tất cả
                              </label>
                            </div>
                            <div class="d-flex align-item-center">
                              <select class="form-control form-control-lg checkbox-select-all-options" name="action" required>
                                <option value ="">-- Hành động --</option>
                                <option value = "toship">Đã chuẩn bị hàng</option>
                              </select>
                               <button class="btn btn-primary check-all-submit-btn" disabled> Thực hiện </button>
                            </div>

                            
                          </div>
                            <div class="app-content-5">
                                <table class="table-manage-product table-striped text-center table-bordered">
                                    <thead>
                                        <colgroup>
                                            <col width="30" span="1">
                                            <col width="30" span="1">
                                            <col width="500" span="1">
                                            <col width="100" span="1">
                                            <col width="90" span="1">
                                            <col width="150" span="1">
                                            <col width="120" span="1">
                                            <col width="140" span="1">
                                            <col width="100" span="1">
                                           
                                        </colgroup>
                                        <tr class="table-primary">
                                            <th scope="col" colspan="2">#</th>
                                            <th scope="col ">
                                                ID đơn hàng
                                                 {{{sortable '_id' _sort}}}
                                            </th>
                                            <th scope="col">
                                                Sản phẩm
                                                {{{sortable 'products.tittle' _sort}}}
                                            </th>
                                            <th scope="col">
                                                Số lượng
                                               {{{sortable 'products.quantity' _sort}}}
                                            </th>
                                            <th scope="col">
                                               Tổng tiền
                                                {{{sortable 'products.total_cost' _sort}}}
                                            </th>
                                            <th scope="col">
                                               Địa chỉ giao hàng
                                                {{{sortable 'address' _sort}}}
                                            </th>
                                            <th scope="col">
                                               Người mua
                                                {{{sortable 'name' _sort}}}
                                            </th>
                                            <th scope="col">
                                               Thời gian tạo
                                                 {{{sortable 'createdAt' _sort}}}
                                            </th>
                                            <th scope="col">
                                                Thao tác
                                                
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each orders}}
                                           
                                        <tr class="">
                                                <td>
                                              <div class="form-check">
                                              <input class="form-check-input" type="checkbox" name="orderIds[]" value="{{this._id}}">
                                              </div>
                                            </td>

                                            <th scope="row">{{sum @index 1}}</th>
                                             <td>{{this._id}}</td>
                                             <td>
                                        {{#each products}}
                                            {{#unless @first}}</br> {{/unless}}
                                            {{this.tittle}}
                                        {{/each}}</td>

                                            <td>
                                        {{#each products}}
                                            {{#unless @first}}</br> {{/unless}}
                                            {{this.quantity}}
                                        {{/each}}</td>
                                        
                                             <td>{{this.payment}}</td>

                                        <td>{{this.address}}</td>

                                        <td> 
                                            {{this.name}}
                                          </td>
                                        

                                        <td>{{this.createdAt}}</td>
                                        <td>
                                          <a href="/me/stored/orders/{{this._id}}/shipment-ready" class="btn btn-primary">Đã chuẩn bị hàng</a>
                                        </td>

                                        </tr>
                                        {{else}}
                                        <tr>
                                        <td colspan="10" class="text-center"> 
                                        Bạn không có đơn hàng nào chờ lấy hàng
                                        {{!-- <a href="/courses/create">Đăng khóa học.</a> --}}
                                        </td>
                                        </tr>
                                        {{/each}}
                                    
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </form>


<div id="delete-course-modal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Hủy đơn hàng</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Bạn chắc chắn muốn hủy đơn hàng này?</p>
      </div>
      <div class="modal-footer">
        <button id="btn-delete-course" type="button" class="btn btn-danger">Xóa bỏ</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
      </div>
    </div>
  </div>
</div>



<form name="delete-course-form" method="GET"></form>

<script>
    document.addEventListener('DOMContentLoaded', function (){
        var orderId;
        var btnDeleteCourse = document.getElementById('btn-delete-course')
        var deleteForm = document.forms['delete-course-form']
        var checkboxAll = $('#checkbox-all')
        var orderItemCheckbox = $('input[name="orderIds[]"]')
        var checkAllSubmitBtn = $('.check-all-submit-btn')
        var containerForm = document.forms['container-form']

        //when dialog confirm clicked
         $('#delete-course-modal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) 
        orderId = button.data('id')
    });

    btnDeleteCourse.onclick = function(){
        deleteForm.action = '/me/stored/orders/' + orderId + '/cancel';
        deleteForm.submit();

    }

    //Checkbox all changed
    checkboxAll.change(function() {
      var isCheckedAll = $(this).prop('checked');
       orderItemCheckbox.prop('checked', isCheckedAll);
       renderCheckAllSubmitBn();
    });

    //Order item checkbox changed
    orderItemCheckbox.change(function(){
      var isCheckedAll = orderItemCheckbox.length === $('input[name="orderIds[]"]:checked').length;
      checkboxAll.prop('checked', isCheckedAll );
       renderCheckAllSubmitBn();
    })


    //Re-render button submit all
    function renderCheckAllSubmitBn(){
      var checkCount = $('input[name="orderIds[]"]:checked').length;
      if (checkCount > 0)
      {
        checkAllSubmitBtn.attr('disabled', false);
      }
      else{
        checkAllSubmitBtn.attr('disabled', true);
      }
    } 
    
});
</script>



    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
        crossorigin="anonymous"></script>
    
</body>

</html>